@include('templates.header', ['title' => 'Особистий кабінет'])

<section class="account">
    <div class="container">

        <div class="head">
            <h2 class="hero__title">
                Особистий кабінет
            </h2>
            <div class="bonuses title_20">
                Мої бонуси:<span> {{ $client->formattedBonuses() }}</span>
            </div>
        </div>

        <div class="account_List">
            
            <div class="account_block history">
                <div class="banner">
                    <div class="title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                            <path
                            d="M24.3097 5.49956C14.978 5.2429 7.33298 12.7412 7.33298 21.9996H4.05132C3.22632 21.9996 2.82298 22.9896 3.40965 23.5579L8.52465 28.6912C8.89132 29.0579 9.45965 29.0579 9.82632 28.6912L14.9413 23.5579C15.068 23.4287 15.1536 23.2648 15.1873 23.087C15.221 22.9092 15.2014 22.7254 15.1308 22.5587C15.0602 22.3921 14.9419 22.25 14.7907 22.1505C14.6395 22.051 14.4623 21.9985 14.2813 21.9996H10.9996C10.9996 14.8496 16.8296 9.07456 24.0163 9.16623C30.8363 9.2579 36.5746 14.9962 36.6663 21.8162C36.758 28.9846 30.983 34.8329 23.833 34.8329C20.8813 34.8329 18.1496 33.8246 15.9863 32.1196C15.6352 31.8429 15.1946 31.705 14.7484 31.7321C14.3022 31.7591 13.8815 31.9492 13.5663 32.2662C12.7963 33.0362 12.8513 34.3379 13.713 34.9979C16.5935 37.2755 20.1608 38.5098 23.833 38.4996C33.0913 38.4996 40.5896 30.8546 40.333 21.5229C40.0947 12.9246 32.908 5.7379 24.3097 5.49956ZM23.3746 14.6662C22.623 14.6662 21.9996 15.2896 21.9996 16.0412V22.7879C21.9996 23.4296 22.348 24.0346 22.898 24.3646L28.618 27.7562C29.278 28.1412 30.1213 27.9212 30.5063 27.2796C30.8913 26.6196 30.6713 25.7762 30.0296 25.3912L24.7496 22.2562V16.0229C24.7496 15.2896 24.1263 14.6662 23.3746 14.6662Z"
                            fill="#323232"/>
                        </svg> 
                        Історія замовлень
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                        <path
                            d="M11.5423 15.2092C11.3705 15.3796 11.2341 15.5824 11.141 15.8058C11.0479 16.0292 11 16.2688 11 16.5109C11 16.7529 11.0479 16.9925 11.141 17.2159C11.2341 17.4393 11.3705 17.6421 11.5423 17.8125L20.709 26.9792C20.8794 27.151 21.0822 27.2874 21.3056 27.3805C21.529 27.4736 21.7686 27.5215 22.0106 27.5215C22.2527 27.5215 22.4923 27.4736 22.7157 27.3805C22.9391 27.2874 23.1419 27.151 23.3123 26.9792L32.479 17.8125C32.6508 17.6421 32.7872 17.4393 32.8803 17.2159C32.9733 16.9925 33.0213 16.7529 33.0213 16.5109C33.0213 16.2688 32.9733 16.0292 32.8803 15.8058C32.7872 15.5824 32.6508 15.3796 32.479 15.2092C32.3085 15.0374 32.1058 14.901 31.8824 14.8079C31.6589 14.7148 31.4193 14.6669 31.1773 14.6669C30.9353 14.6669 30.6956 14.7148 30.4722 14.8079C30.2488 14.901 30.0461 15.0374 29.8756 15.2092L22.0106 23.0925L14.1456 15.2092C13.9752 15.0374 13.7724 14.901 13.549 14.8079C13.3256 14.7148 13.086 14.6669 12.844 14.6669C12.6019 14.6669 12.3623 14.7148 12.1389 14.8079C11.9155 14.901 11.7127 15.0374 11.5423 15.2092Z"
                            fill="black"/>
                    </svg>
                </div>
                <div class="content">
                    @if ($client->orders->count())
                    <div class="history-list">
                    @foreach ($client
                        ->orders()
                        ->orderBy('created_at', 'DESC')
                        ->get() as $order)

                        @if ($order->type == App\Models\Order::FOOD_SHIPPING)
                        <div class="history-item" data-id="{{ $order->id }}">
                            <p class="date">
                                {{ $order->created_at->format('d.m.Y') }}
                            </p>
                            <p class="position">
                                {{ $order->orderItems->implode(fn ($item) => "{$item->name} x {$item->quantity}", ', ') }}
                            </p>
                            <p class="adress">
                                {{ implode(', ', array_map(fn (array $address) => $address['address'], $order->details['food_to'])) }}
                            </p>
                            <p class="number">
                                №{{ $order->id }}
                            </p>
                            <p class="sum-total">
                                {{ $order->totalFormatted('₴') }}
                            </p>
                            <button class="btn food">
                                Повторити
                            </button>
                        </div>
                        @endif

                        @if ($order->type == App\Models\Order::SHIPPING)
                        <div class="history-item">
                            <p class="date">
                                {{ $order->created_at->format('d.m.Y') }}
                            </p>
                            <p class="position">
                                Кур'єр
                            </p>
                            <p class="adress">
                                {{ $order->details['shipping_from']['address'] }} - {{ implode(', ', array_map(fn (array $address) => $address['address'], $order->details['shipping_to'])) }}
                            </p>
                            <p class="number">
                                №{{ $order->id }}
                            </p>
                            <p class="sum-total">
                                {{ $order->totalFormatted('₴') }}
                            </p>
                            <a class="btn" href="{{ route('pages.order-car', ['order' => $order->id]) }}">
                                Повторити
                            </a>
                        </div>
                        @endif

                        @if ($order->type == App\Models\Order::TAXI)
                        <div class="history-item">
                            <p class="date">
                                {{ $order->created_at->format('d.m.Y') }}
                            </p>
                            <p class="position">
                                Таксі
                            </p>
                            <p class="adress">
                                {{ $order->details['taxi_from']['address'] }} - {{ implode(', ', array_map(fn (array $address) => $address['address'], $order->details['taxi_to'])) }}
                            </p>
                            <p class="number">
                                №{{ $order->id }}
                            </p>
                            <p class="sum-total">
                                {{ $order->totalFormatted('₴') }}
                            </p>
                            <a class="btn" href="{{ route('pages.order-car', ['order' => $order->id]) }}">
                                Повторити
                            </a>
                        </div>
                        @endif

                    @endforeach
                    </div>
                    @else
                    <div class="empty">
                        Ви ще не зробили ні одного замовлення
                    </div>
                    @endif
                </div>
            </div>

            <div class="account_block personal">
                <div class="banner">
                    <div class="title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                            <path
                            d="M18.3327 7.33301C16.3878 7.33301 14.5225 8.10562 13.1472 9.48089C11.772 10.8562 10.9993 12.7214 10.9993 14.6663C10.9993 16.6113 11.772 18.4765 13.1472 19.8518C14.5225 21.2271 16.3878 21.9997 18.3327 21.9997C20.2776 21.9997 22.1429 21.2271 23.5181 19.8518C24.8934 18.4765 25.666 16.6113 25.666 14.6663C25.666 12.7214 24.8934 10.8562 23.5181 9.48089C22.1429 8.10562 20.2776 7.33301 18.3327 7.33301ZM18.3327 10.9997C19.3051 10.9997 20.2378 11.386 20.9254 12.0736C21.613 12.7612 21.9993 13.6939 21.9993 14.6663C21.9993 15.6388 21.613 16.5714 20.9254 17.2591C20.2378 17.9467 19.3051 18.333 18.3327 18.333C17.3602 18.333 16.4276 17.9467 15.74 17.2591C15.0523 16.5714 14.666 15.6388 14.666 14.6663C14.666 13.6939 15.0523 12.7612 15.74 12.0736C16.4276 11.386 17.3602 10.9997 18.3327 10.9997ZM31.166 21.9997C30.8727 21.9997 30.726 22.1463 30.726 22.4397L30.2493 24.7497C29.846 25.0797 29.2593 25.373 28.8193 25.6663L26.4727 24.7497C26.326 24.7497 26.0327 24.7497 25.886 24.933L24.126 28.1597C23.9793 28.3063 23.9793 28.5997 24.2727 28.7463L26.1793 30.2497V32.083L24.2727 33.5863C24.126 33.733 23.9793 34.0263 24.126 34.173L25.886 37.3997C26.0327 37.583 26.326 37.583 26.4727 37.583L28.8193 36.6663C29.2593 36.9597 29.846 37.253 30.2493 37.583L30.726 39.893C30.726 40.1863 30.8727 40.333 31.166 40.333H34.8327C34.9793 40.333 35.2727 40.1863 35.2727 39.893L35.566 37.583C36.1527 37.253 36.7393 36.9597 37.1794 36.6663L39.416 37.583C39.6727 37.583 39.966 37.583 39.966 37.3997L41.8727 34.173C42.0194 34.0263 41.8727 33.733 41.726 33.5863L39.8193 32.083V30.2497L41.726 28.7463C41.8727 28.5997 42.0194 28.3063 41.8727 28.1597L39.966 24.933C39.966 24.7497 39.6727 24.7497 39.416 24.7497L37.1794 25.6663C36.7393 25.373 36.1527 25.0797 35.566 24.7497L35.2727 22.4397C35.2727 22.1463 34.9793 21.9997 34.8327 21.9997H31.166ZM18.3327 23.833C13.4377 23.833 3.66602 26.2713 3.66602 31.1663V36.6663H21.3944C20.881 35.5847 20.5143 34.4113 20.331 33.183H7.14935V31.1663C7.14935 29.993 12.8877 27.3163 18.3327 27.3163C19.121 27.3163 19.9277 27.3897 20.716 27.4997C21.0827 26.3263 21.5777 25.2263 22.2193 24.218C20.7893 23.9797 19.4327 23.833 18.3327 23.833ZM33.0727 28.4163C34.5394 28.4163 35.7494 29.6263 35.7494 31.2397C35.7494 32.7063 34.5394 33.9163 33.0727 33.9163C31.4594 33.9163 30.2493 32.7063 30.2493 31.2397C30.2493 29.6263 31.4594 28.4163 33.0727 28.4163Z"
                            fill="#323232"
                            />
                        </svg> 
                        Персональні дані
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                        <path
                            d="M11.5423 15.2092C11.3705 15.3796 11.2341 15.5824 11.141 15.8058C11.0479 16.0292 11 16.2688 11 16.5109C11 16.7529 11.0479 16.9925 11.141 17.2159C11.2341 17.4393 11.3705 17.6421 11.5423 17.8125L20.709 26.9792C20.8794 27.151 21.0822 27.2874 21.3056 27.3805C21.529 27.4736 21.7686 27.5215 22.0106 27.5215C22.2527 27.5215 22.4923 27.4736 22.7157 27.3805C22.9391 27.2874 23.1419 27.151 23.3123 26.9792L32.479 17.8125C32.6508 17.6421 32.7872 17.4393 32.8803 17.2159C32.9733 16.9925 33.0213 16.7529 33.0213 16.5109C33.0213 16.2688 32.9733 16.0292 32.8803 15.8058C32.7872 15.5824 32.6508 15.3796 32.479 15.2092C32.3085 15.0374 32.1058 14.901 31.8824 14.8079C31.6589 14.7148 31.4193 14.6669 31.1773 14.6669C30.9353 14.6669 30.6956 14.7148 30.4722 14.8079C30.2488 14.901 30.0461 15.0374 29.8756 15.2092L22.0106 23.0925L14.1456 15.2092C13.9752 15.0374 13.7724 14.901 13.549 14.8079C13.3256 14.7148 13.086 14.6669 12.844 14.6669C12.6019 14.6669 12.3623 14.7148 12.1389 14.8079C11.9155 14.901 11.7127 15.0374 11.5423 15.2092Z"
                            fill="black"
                        />
                    </svg>
                </div>
                <div class="content">
                    <div class="pesonal-data">
                        <form id="update-personal-info">
                            <div class="input-box">
                                <input 
                                    type="text" 
                                    name="full_name" 
                                    placeholder="Ваше ім’я та прізвище*"
                                    value="{{ $client->full_name }}"/>
                            </div>

                            <div class="input-box">
                                <input 
                                    type="tel" 
                                    name="phone" 
                                    placeholder="(090) 111-11-11"
                                    value="{{ $client->phone }}"/>
                            </div>
       
                            <div class="buttons">
                                <button class="btn" type="submit">
                                    Зберегти
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="account_block address">
                <div class="banner">
                    <div class="title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                            <path
                            d="M22.0003 11.917C23.2159 11.917 24.3817 12.3999 25.2412 13.2594C26.1008 14.119 26.5837 15.2847 26.5837 16.5003C26.5837 17.1022 26.4651 17.6982 26.2348 18.2543C26.0044 18.8104 25.6668 19.3156 25.2412 19.7412C24.8156 20.1668 24.3104 20.5044 23.7543 20.7348C23.1982 20.9651 22.6022 21.0837 22.0003 21.0837C20.7847 21.0837 19.619 20.6008 18.7594 19.7412C17.8999 18.8817 17.417 17.7159 17.417 16.5003C17.417 15.2847 17.8999 14.119 18.7594 13.2594C19.619 12.3999 20.7847 11.917 22.0003 11.917ZM22.0003 3.66699C25.4039 3.66699 28.6681 5.01907 31.0749 7.42579C33.4816 9.83251 34.8337 13.0967 34.8337 16.5003C34.8337 26.1253 22.0003 40.3337 22.0003 40.3337C22.0003 40.3337 9.16699 26.1253 9.16699 16.5003C9.16699 13.0967 10.5191 9.83251 12.9258 7.42579C15.3325 5.01907 18.5967 3.66699 22.0003 3.66699ZM22.0003 7.33366C19.5692 7.33366 17.2376 8.29943 15.5185 10.0185C13.7994 11.7376 12.8337 14.0692 12.8337 16.5003C12.8337 18.3337 12.8337 22.0003 22.0003 34.302C31.167 22.0003 31.167 18.3337 31.167 16.5003C31.167 14.0692 30.2012 11.7376 28.4821 10.0185C26.7631 8.29943 24.4315 7.33366 22.0003 7.33366Z"
                            fill="#323232"/>
                        </svg> 
                        Адреси доставки
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                        <path
                            d="M11.5423 15.2092C11.3705 15.3796 11.2341 15.5824 11.141 15.8058C11.0479 16.0292 11 16.2688 11 16.5109C11 16.7529 11.0479 16.9925 11.141 17.2159C11.2341 17.4393 11.3705 17.6421 11.5423 17.8125L20.709 26.9792C20.8794 27.151 21.0822 27.2874 21.3056 27.3805C21.529 27.4736 21.7686 27.5215 22.0106 27.5215C22.2527 27.5215 22.4923 27.4736 22.7157 27.3805C22.9391 27.2874 23.1419 27.151 23.3123 26.9792L32.479 17.8125C32.6508 17.6421 32.7872 17.4393 32.8803 17.2159C32.9733 16.9925 33.0213 16.7529 33.0213 16.5109C33.0213 16.2688 32.9733 16.0292 32.8803 15.8058C32.7872 15.5824 32.6508 15.3796 32.479 15.2092C32.3085 15.0374 32.1058 14.901 31.8824 14.8079C31.6589 14.7148 31.4193 14.6669 31.1773 14.6669C30.9353 14.6669 30.6956 14.7148 30.4722 14.8079C30.2488 14.901 30.0461 15.0374 29.8756 15.2092L22.0106 23.0925L14.1456 15.2092C13.9752 15.0374 13.7724 14.901 13.549 14.8079C13.3256 14.7148 13.086 14.6669 12.844 14.6669C12.6019 14.6669 12.3623 14.7148 12.1389 14.8079C11.9155 14.901 11.7127 15.0374 11.5423 15.2092Z"
                            fill="black"/>
                    </svg>
                </div>
                <div class="content">
                    <div class="delivery-addressForm">
                        <form id="new-address" class="hide">
                            <div class="input-box">
                                <input 
                                    class="autocomplete"
                                    type="text" 
                                    name="address" 
                                    placeholder="Адреса*" />
                            </div>
                            <div class="buttons">
                                <button class="btn" type="submit">
                                    Додати
                                </button>
                            </div>
                        </form>
                    </div>

                    @include('templates.addresses', ['addresses' => $client->addresses,])

                    <div class="addNew">
                        + Додати нову адресу
                    </div>
                </div>
            </div>

            <div class="account_block notification">
                <div class="banner">
                    <div class="title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                            <path
                            fill-rule="evenodd"
                            clip-rule="evenodd"
                            d="M9.16658 16.5003C9.16658 13.0967 10.5187 9.8325 12.9254 7.42579C15.3321 5.01907 18.5963 3.66699 21.9999 3.66699C25.4035 3.66699 28.6677 5.01907 31.0744 7.42579C33.4812 9.8325 34.8332 13.0967 34.8332 16.5003V23.401L38.1736 30.0817C38.3274 30.3891 38.4 30.7308 38.3845 31.0743C38.3691 31.4177 38.2661 31.7515 38.0853 32.044C37.9046 32.3364 37.6521 32.5778 37.3518 32.7452C37.0515 32.9125 36.7134 33.0004 36.3696 33.0003H29.1022C28.6944 34.5738 27.7757 35.9672 26.4902 36.962C25.2048 37.9568 23.6253 38.4966 21.9999 38.4966C20.3745 38.4966 18.7951 37.9568 17.5096 36.962C16.2241 35.9672 15.3054 34.5738 14.8976 33.0003H7.63025C7.28646 33.0004 6.94836 32.9125 6.64807 32.7452C6.34778 32.5778 6.09527 32.3364 5.91451 32.044C5.73376 31.7515 5.63077 31.4177 5.61532 31.0743C5.59987 30.7308 5.67248 30.3891 5.82625 30.0817L9.16658 23.401V16.5003ZM18.8246 33.0003C19.1464 33.5577 19.6093 34.0205 20.1667 34.3423C20.724 34.6641 21.3563 34.8335 21.9999 34.8335C22.6435 34.8335 23.2758 34.6641 23.8332 34.3423C24.3906 34.0205 24.8534 33.5577 25.1752 33.0003H18.8246ZM21.9999 7.33366C19.5688 7.33366 17.2372 8.29943 15.5181 10.0185C13.799 11.7376 12.8332 14.0692 12.8332 16.5003V23.401C12.8332 23.9699 12.7008 24.5311 12.4464 25.04L10.3014 29.3337H33.7002L31.5552 25.04C31.3003 24.5312 31.1672 23.9701 31.1666 23.401V16.5003C31.1666 14.0692 30.2008 11.7376 28.4817 10.0185C26.7626 8.29943 24.4311 7.33366 21.9999 7.33366Z"
                            fill="#323232"/>
                        </svg> 
                        Сповіщення
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                        <path
                            d="M11.5423 15.2092C11.3705 15.3796 11.2341 15.5824 11.141 15.8058C11.0479 16.0292 11 16.2688 11 16.5109C11 16.7529 11.0479 16.9925 11.141 17.2159C11.2341 17.4393 11.3705 17.6421 11.5423 17.8125L20.709 26.9792C20.8794 27.151 21.0822 27.2874 21.3056 27.3805C21.529 27.4736 21.7686 27.5215 22.0106 27.5215C22.2527 27.5215 22.4923 27.4736 22.7157 27.3805C22.9391 27.2874 23.1419 27.151 23.3123 26.9792L32.479 17.8125C32.6508 17.6421 32.7872 17.4393 32.8803 17.2159C32.9733 16.9925 33.0213 16.7529 33.0213 16.5109C33.0213 16.2688 32.9733 16.0292 32.8803 15.8058C32.7872 15.5824 32.6508 15.3796 32.479 15.2092C32.3085 15.0374 32.1058 14.901 31.8824 14.8079C31.6589 14.7148 31.4193 14.6669 31.1773 14.6669C30.9353 14.6669 30.6956 14.7148 30.4722 14.8079C30.2488 14.901 30.0461 15.0374 29.8756 15.2092L22.0106 23.0925L14.1456 15.2092C13.9752 15.0374 13.7724 14.901 13.549 14.8079C13.3256 14.7148 13.086 14.6669 12.844 14.6669C12.6019 14.6669 12.3623 14.7148 12.1389 14.8079C11.9155 14.901 11.7127 15.0374 11.5423 15.2092Z"
                            fill="black"/>
                    </svg>
                </div>
                <div class="content">
                    <div class="empty">
                        Повідомлень не знайдено
                    </div>
                </div>
            </div>

        </div>

        <div class="acc-nav">
            <div class="btn" id="logOut">
                Вихід
            </div>
            <div class="deleteAcc" id="deleteAcc">
                Видалити обліковий запис
            </div>
        </div>
        
    </div>
</section>

<script src="https://maps.googleapis.com/maps/api/js?key={{ config('services.google_maps_key') }}&libraries=places&language=uk&region=ua"></script>

@include('modals.delete')

@include('templates.footer')